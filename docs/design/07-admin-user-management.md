# ê´€ë¦¬ì íšŒì› ê´€ë¦¬ ì„¤ê³„

## 1. ê°œìš”

ê´€ë¦¬ì íšŒì› ê´€ë¦¬ ê¸°ëŠ¥ì€ ì‹œìŠ¤í…œ ê´€ë¦¬ìê°€ íšŒì› ì •ë³´ë¥¼ ì¡°íšŒ, ê²€ìƒ‰, ìˆ˜ì •, ìƒíƒœ ë³€ê²½í•  ìˆ˜ ìˆëŠ” ê¸°ëŠ¥ì„ ì œê³µí•©ë‹ˆë‹¤. ê¶Œí•œ ìˆ˜ì¤€ì— ë”°ë¼ ì ‘ê·¼ ê°€ëŠ¥í•œ ê¸°ëŠ¥ì´ ì œí•œë©ë‹ˆë‹¤.

---

## 2. ê¶Œí•œ ì²´ê³„

### 2.1 ì—­í• ë³„ ê¶Œí•œ

| ê¸°ëŠ¥ | USER | COMPANY_ADMIN | SUPPLIER_ADMIN | ADMIN | SUPER_ADMIN |
|------|------|---------------|----------------|-------|-------------|
| íšŒì› ëª©ë¡ ì¡°íšŒ | âŒ | âŒ | âŒ | âœ… | âœ… |
| íšŒì› ìƒì„¸ ì¡°íšŒ | âŒ | âŒ | âŒ | âœ… | âœ… |
| íšŒì› ì •ë³´ ìˆ˜ì • | âŒ | âŒ | âŒ | âœ… | âœ… |
| íšŒì› ìƒíƒœ ë³€ê²½ | âŒ | âŒ | âŒ | âœ… | âœ… |
| íšŒì› ì—­í•  ë³€ê²½ | âŒ | âŒ | âŒ | âŒ | âœ… |
| íšŒì› ì‚­ì œ | âŒ | âŒ | âŒ | âœ… | âœ… |
| ê´€ë¦¬ì ê³„ì • ìƒì„± | âŒ | âŒ | âŒ | âŒ | âœ… |

### 2.2 ìƒíƒœ ë³€ê²½ ê°€ëŠ¥ ë²”ìœ„

| í˜„ì¬ ìƒíƒœ | ë³€ê²½ ê°€ëŠ¥ ìƒíƒœ | ê¶Œí•œ |
|----------|---------------|------|
| ACTIVE | INACTIVE, SUSPENDED | ADMIN |
| INACTIVE | ACTIVE, SUSPENDED | ADMIN |
| SUSPENDED | ACTIVE, INACTIVE | ADMIN |
| DELETED | ë³µêµ¬ ë¶ˆê°€ | - |

---

## 3. API ì„¤ê³„

### 3.1 íšŒì› ê´€ë¦¬ API

| Method | Endpoint | ì„¤ëª… | ê¶Œí•œ |
|--------|----------|------|------|
| GET | /admin/users | íšŒì› ëª©ë¡ ì¡°íšŒ | ADMIN |
| GET | /admin/users/{id} | íšŒì› ìƒì„¸ ì¡°íšŒ | ADMIN |
| GET | /admin/users/search | íšŒì› ê²€ìƒ‰ | ADMIN |
| PUT | /admin/users/{id} | íšŒì› ì •ë³´ ìˆ˜ì • | ADMIN |
| PATCH | /admin/users/{id}/status | ìƒíƒœ ë³€ê²½ | ADMIN |
| PATCH | /admin/users/{id}/role | ì—­í•  ë³€ê²½ | SUPER_ADMIN |
| DELETE | /admin/users/{id} | íšŒì› ì‚­ì œ | ADMIN |
| POST | /admin/users | ê´€ë¦¬ì ê³„ì • ìƒì„± | SUPER_ADMIN |

### 3.2 íšŒì› ì—°ê´€ ë°ì´í„° API

| Method | Endpoint | ì„¤ëª… | ê¶Œí•œ |
|--------|----------|------|------|
| GET | /admin/users/{id}/pets | íšŒì›ì˜ ë°˜ë ¤ë™ë¬¼ ëª©ë¡ | ADMIN |
| GET | /admin/users/{id}/coupons | íšŒì›ì˜ ì¿ í° ëª©ë¡ | ADMIN |
| GET | /admin/users/{id}/orders | íšŒì›ì˜ ì£¼ë¬¸ ë‚´ì—­ | ADMIN |
| GET | /admin/users/{id}/reservations | íšŒì›ì˜ ì˜ˆì•½ ë‚´ì—­ | ADMIN |
| GET | /admin/users/{id}/activity-logs | íšŒì› í™œë™ ë¡œê·¸ | ADMIN |

---

## 4. ìš”ì²­/ì‘ë‹µ DTO

### 4.1 íšŒì› ëª©ë¡ ì¡°íšŒ ìš”ì²­

```
GET /admin/users?page=0&size=20&sort=createdAt,desc&status=ACTIVE&role=USER&keyword=í™ê¸¸ë™
```

| íŒŒë¼ë¯¸í„° | íƒ€ì… | í•„ìˆ˜ | ì„¤ëª… |
|----------|------|------|------|
| page | Integer | X | í˜ì´ì§€ ë²ˆí˜¸ (ê¸°ë³¸: 0) |
| size | Integer | X | í˜ì´ì§€ í¬ê¸° (ê¸°ë³¸: 20) |
| sort | String | X | ì •ë ¬ (ê¸°ë³¸: createdAt,desc) |
| status | String | X | ìƒíƒœ í•„í„° |
| role | String | X | ì—­í•  í•„í„° |
| keyword | String | X | ê²€ìƒ‰ì–´ (ì´ë¦„, ì´ë©”ì¼, ì „í™”ë²ˆí˜¸) |
| startDate | LocalDate | X | ê°€ì…ì¼ ì‹œì‘ |
| endDate | LocalDate | X | ê°€ì…ì¼ ì¢…ë£Œ |

### 4.2 íšŒì› ëª©ë¡ ì‘ë‹µ

```json
{
  "content": [
    {
      "id": 1,
      "email": "user@example.com",
      "name": "í™ê¸¸ë™",
      "phone": "010-1234-5678",
      "role": "USER",
      "roleName": "ì¼ë°˜ ì‚¬ìš©ì",
      "status": "ACTIVE",
      "statusName": "í™œì„±",
      "petCount": 2,
      "couponCount": 5,
      "lastLoginAt": "2025-01-25T09:30:00",
      "createdAt": "2025-01-20T14:30:00"
    }
  ],
  "totalElements": 150,
  "totalPages": 8,
  "number": 0,
  "size": 20
}
```

### 4.3 íšŒì› ìƒì„¸ ì‘ë‹µ

```json
{
  "id": 1,
  "email": "user@example.com",
  "name": "í™ê¸¸ë™",
  "phone": "010-1234-5678",
  "birthDate": "1990-05-15",
  "address": "ì„œìš¸íŠ¹ë³„ì‹œ ê°•ë‚¨êµ¬ í…Œí—¤ë€ë¡œ 123",
  "addressDetail": "101ë™ 202í˜¸",
  "zipCode": "06141",
  "latitude": 37.5065,
  "longitude": 127.0536,
  "role": "USER",
  "roleName": "ì¼ë°˜ ì‚¬ìš©ì",
  "status": "ACTIVE",
  "statusName": "í™œì„±",
  "profileImageUrl": "https://storage.findplace.com/profiles/1.jpg",
  "lastLoginAt": "2025-01-25T09:30:00",
  "createdAt": "2025-01-20T14:30:00",
  "updatedAt": "2025-01-25T10:00:00",
  "summary": {
    "petCount": 2,
    "alivePetCount": 1,
    "deceasedPetCount": 1,
    "activeCouponCount": 5,
    "usedCouponCount": 3,
    "totalOrderCount": 10,
    "totalOrderAmount": 1500000,
    "reservationCount": 2
  }
}
```

### 4.4 ìƒíƒœ ë³€ê²½ ìš”ì²­

```json
{
  "status": "SUSPENDED",
  "reason": "ë¹„ì •ìƒì ì¸ í™œë™ ê°ì§€"
}
```

### 4.5 ì—­í•  ë³€ê²½ ìš”ì²­

```json
{
  "role": "COMPANY_ADMIN",
  "reason": "ì—…ì²´ ê´€ë¦¬ì ê¶Œí•œ ë¶€ì—¬"
}
```

### 4.6 íšŒì› ì •ë³´ ìˆ˜ì • ìš”ì²­

```json
{
  "name": "í™ê¸¸ë™",
  "phone": "010-9876-5432",
  "birthDate": "1990-05-15",
  "address": "ì„œìš¸íŠ¹ë³„ì‹œ ì„œì´ˆêµ¬ ì„œì´ˆëŒ€ë¡œ 456",
  "addressDetail": "201ë™ 301í˜¸",
  "zipCode": "06500"
}
```

---

## 5. ë¹„ì¦ˆë‹ˆìŠ¤ ë¡œì§

### 5.1 íšŒì› ê²€ìƒ‰ ë¡œì§

```java
@Service
public class AdminUserService {

    public Page<UserListDto> searchUsers(UserSearchRequest request, Pageable pageable) {
        Specification<User> spec = Specification.where(null);

        if (StringUtils.hasText(request.getKeyword())) {
            spec = spec.and((root, query, cb) ->
                cb.or(
                    cb.like(root.get("name"), "%" + request.getKeyword() + "%"),
                    cb.like(root.get("email"), "%" + request.getKeyword() + "%"),
                    cb.like(root.get("phone"), "%" + request.getKeyword() + "%")
                )
            );
        }

        if (request.getStatus() != null) {
            spec = spec.and((root, query, cb) ->
                cb.equal(root.get("status"), request.getStatus())
            );
        }

        if (request.getRole() != null) {
            spec = spec.and((root, query, cb) ->
                cb.equal(root.get("role"), request.getRole())
            );
        }

        // Soft Delete ì œì™¸
        spec = spec.and((root, query, cb) -> cb.isNull(root.get("deletedAt")));

        return userRepository.findAll(spec, pageable)
            .map(this::toListDto);
    }
}
```

### 5.2 ìƒíƒœ ë³€ê²½ ë¡œì§

```java
@Transactional
public void changeStatus(Long userId, StatusChangeRequest request, Long adminId) {
    User user = userRepository.findById(userId)
        .orElseThrow(() -> new EntityNotFoundException("User not found"));

    // ìƒíƒœ ë³€ê²½ ìœ íš¨ì„± ê²€ì‚¬
    validateStatusChange(user.getStatus(), request.getStatus());

    user.setStatus(request.getStatus());

    // ë³€ê²½ ì´ë ¥ ì €ì¥
    UserStatusChangeLog log = new UserStatusChangeLog();
    log.setUserId(userId);
    log.setFromStatus(user.getStatus());
    log.setToStatus(request.getStatus());
    log.setReason(request.getReason());
    log.setChangedBy(adminId);
    log.setChangedAt(LocalDateTime.now());
    statusChangeLogRepository.save(log);

    // ì •ì§€ ì‹œ ì•Œë¦¼ ë°œì†¡
    if (request.getStatus() == UserStatus.SUSPENDED) {
        notificationService.sendSuspensionNotice(user, request.getReason());
    }
}
```

### 5.3 ì—­í•  ë³€ê²½ ë¡œì§

```java
@Transactional
@PreAuthorize("hasRole('SUPER_ADMIN')")
public void changeRole(Long userId, RoleChangeRequest request, Long adminId) {
    User user = userRepository.findById(userId)
        .orElseThrow(() -> new EntityNotFoundException("User not found"));

    UserRole oldRole = user.getRole();
    user.setRole(request.getRole());

    // ë³€ê²½ ì´ë ¥ ì €ì¥
    UserRoleChangeLog log = new UserRoleChangeLog();
    log.setUserId(userId);
    log.setFromRole(oldRole);
    log.setToRole(request.getRole());
    log.setReason(request.getReason());
    log.setChangedBy(adminId);
    log.setChangedAt(LocalDateTime.now());
    roleChangeLogRepository.save(log);

    // ì—­í•  ë³€ê²½ ì•Œë¦¼
    notificationService.sendRoleChangeNotice(user, oldRole, request.getRole());
}
```

### 5.4 íšŒì› ì‚­ì œ (Soft Delete)

```java
@Transactional
public void deleteUser(Long userId, Long adminId) {
    User user = userRepository.findById(userId)
        .orElseThrow(() -> new EntityNotFoundException("User not found"));

    // SUPER_ADMINì€ ì‚­ì œ ë¶ˆê°€
    if (user.getRole() == UserRole.SUPER_ADMIN) {
        throw new BusinessException("ìµœê³  ê´€ë¦¬ì ê³„ì •ì€ ì‚­ì œí•  ìˆ˜ ì—†ìŠµë‹ˆë‹¤.");
    }

    // Soft Delete
    user.setDeletedAt(LocalDateTime.now());
    user.setDeletedBy(adminId);
    user.setStatus(UserStatus.DELETED);

    // ê°œì¸ì •ë³´ ë§ˆìŠ¤í‚¹
    user.setEmail(maskEmail(user.getEmail()));
    user.setName("íƒˆí‡´íšŒì›");
    user.setPhone(null);

    // ì‚­ì œ ì´ë²¤íŠ¸ ë°œí–‰
    eventPublisher.publishEvent(new UserDeleteEvent(userId, adminId));
}
```

---

## 6. í”„ë¡ íŠ¸ì—”ë“œ UI

### 6.1 íšŒì› ëª©ë¡ í˜ì´ì§€

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  íšŒì› ê´€ë¦¬                                                    [+ íšŒì› ìƒì„±] â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                          â”‚
â”‚  ê²€ìƒ‰: [                    ğŸ”]                                          â”‚
â”‚                                                                          â”‚
â”‚  ìƒíƒœ: [ì „ì²´ â–¼]  ì—­í• : [ì „ì²´ â–¼]  ê°€ì…ì¼: [ì‹œì‘ì¼] ~ [ì¢…ë£Œì¼]  [ê²€ìƒ‰] [ì´ˆê¸°í™”]â”‚
â”‚                                                                          â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  â˜ â”‚ ì´ë©”ì¼              â”‚ ì´ë¦„    â”‚ ì—­í•       â”‚ ìƒíƒœ  â”‚ ìµœê·¼ ë¡œê·¸ì¸      â”‚
â”‚â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ â”‚
â”‚  â˜ â”‚ user1@example.com  â”‚ í™ê¸¸ë™  â”‚ ì¼ë°˜ ì‚¬ìš©ìâ”‚ í™œì„±  â”‚ 2025-01-25 09:30â”‚
â”‚  â˜ â”‚ admin@example.com  â”‚ ê¹€ê´€ë¦¬  â”‚ ê´€ë¦¬ì    â”‚ í™œì„±  â”‚ 2025-01-25 10:00â”‚
â”‚  â˜ â”‚ user2@example.com  â”‚ ì´ì˜í¬  â”‚ ì¼ë°˜ ì‚¬ìš©ìâ”‚ ì •ì§€  â”‚ 2025-01-20 15:20â”‚
â”‚â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ â”‚
â”‚  ì„ íƒ: 0ëª…                           < 1 2 3 4 5 ... 8 > 20ê°œì”© â–¼         â”‚
â”‚                                                                          â”‚
â”‚  [ìƒíƒœ ë³€ê²½] [ì‚­ì œ]                                                       â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### 6.2 íšŒì› ìƒì„¸ í˜ì´ì§€

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  â† íšŒì› ê´€ë¦¬                                            [ìˆ˜ì •] [ì‚­ì œ]    â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                          â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”                                                              â”‚
â”‚  â”‚ í”„ë¡œí•„  â”‚  í™ê¸¸ë™                                                      â”‚
â”‚  â”‚ ì´ë¯¸ì§€  â”‚  user@example.com                                           â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”˜  ğŸ“ 010-1234-5678                                            â”‚
â”‚              ğŸ‚ 1990-05-15 (35ì„¸)                                         â”‚
â”‚              ğŸ“ ì„œìš¸íŠ¹ë³„ì‹œ ê°•ë‚¨êµ¬ í…Œí—¤ë€ë¡œ 123                              â”‚
â”‚                                                                          â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚  â”‚ ì—­í• : ì¼ë°˜ ì‚¬ìš©ì [ë³€ê²½]     ìƒíƒœ: ğŸŸ¢ í™œì„± [ë³€ê²½]                     â”‚ â”‚
â”‚  â”‚ ê°€ì…ì¼: 2025-01-20          ìµœê·¼ ë¡œê·¸ì¸: 2025-01-25 09:30           â”‚ â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â”‚                                                                          â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚ ë°˜ë ¤ë™ë¬¼ (2)â”‚ ì¿ í° (5) â”‚ ì£¼ë¬¸ (10) â”‚ ì˜ˆì•½ (2) â”‚ í™œë™ ë¡œê·¸          â”‚   â”‚
â”‚  â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤   â”‚
â”‚  â”‚                                                                  â”‚   â”‚
â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                              â”‚   â”‚
â”‚  â”‚  â”‚ ğŸ• ì½©ì´      â”‚ â”‚ ğŸ• ë³´ë¦¬ ğŸŒˆ   â”‚                              â”‚   â”‚
â”‚  â”‚  â”‚ ë§í‹°ì¦ˆ Â· ìˆ˜ì»·â”‚ â”‚ ê³¨ë“ ë¦¬íŠ¸ë¦¬ë²„ â”‚                              â”‚   â”‚
â”‚  â”‚  â”‚ 4ì„¸         â”‚ â”‚ ì¶”ëª¨ ì¤‘      â”‚                              â”‚   â”‚
â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                              â”‚   â”‚
â”‚  â”‚                                                                  â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚                                                                          â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### 6.3 ìƒíƒœ ë³€ê²½ ë‹¤ì´ì–¼ë¡œê·¸

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  íšŒì› ìƒíƒœ ë³€ê²½                      [X] â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                         â”‚
â”‚  ëŒ€ìƒ íšŒì›: í™ê¸¸ë™ (user@example.com)    â”‚
â”‚  í˜„ì¬ ìƒíƒœ: ğŸŸ¢ í™œì„±                      â”‚
â”‚                                         â”‚
â”‚  ë³€ê²½í•  ìƒíƒœ:                           â”‚
â”‚  â—‹ ë¹„í™œì„± - ë¡œê·¸ì¸ ê°€ëŠ¥, ê¸°ëŠ¥ ì œí•œ      â”‚
â”‚  â— ì •ì§€   - ë¡œê·¸ì¸ ë¶ˆê°€                 â”‚
â”‚                                         â”‚
â”‚  ì‚¬ìœ  *                                 â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚  â”‚ ë¹„ì •ìƒì ì¸ í™œë™ ê°ì§€               â”‚ â”‚
â”‚  â”‚                                   â”‚ â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â”‚                                         â”‚
â”‚  âš ï¸ ì •ì§€ ì²˜ë¦¬ ì‹œ íšŒì›ì—ê²Œ ì•Œë¦¼ì´ ë°œì†¡ë©ë‹ˆë‹¤.â”‚
â”‚                                         â”‚
â”‚              [ì·¨ì†Œ]  [ë³€ê²½]              â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### 6.4 ì—­í•  ë³€ê²½ ë‹¤ì´ì–¼ë¡œê·¸ (SUPER_ADMIN ì „ìš©)

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  íšŒì› ì—­í•  ë³€ê²½                      [X] â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                         â”‚
â”‚  ëŒ€ìƒ íšŒì›: ê¹€ê´€ë¦¬ (admin@example.com)   â”‚
â”‚  í˜„ì¬ ì—­í• : ê´€ë¦¬ì (ADMIN)               â”‚
â”‚                                         â”‚
â”‚  ë³€ê²½í•  ì—­í• :                           â”‚
â”‚  â—‹ ì¼ë°˜ ì‚¬ìš©ì (USER)                   â”‚
â”‚  â—‹ ì—…ì²´ ê´€ë¦¬ì (COMPANY_ADMIN)          â”‚
â”‚  â—‹ ê³µê¸‰ì‚¬ ê´€ë¦¬ì (SUPPLIER_ADMIN)       â”‚
â”‚  â— ê´€ë¦¬ì (ADMIN)                       â”‚
â”‚  â—‹ ìµœê³  ê´€ë¦¬ì (SUPER_ADMIN)            â”‚
â”‚                                         â”‚
â”‚  ì‚¬ìœ  *                                 â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚  â”‚ ì—…ì²´ ê´€ë¦¬ì ê¶Œí•œ ë¶€ì—¬              â”‚ â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â”‚                                         â”‚
â”‚  âš ï¸ ì—­í•  ë³€ê²½ì€ ì¦‰ì‹œ ì ìš©ë©ë‹ˆë‹¤.          â”‚
â”‚                                         â”‚
â”‚              [ì·¨ì†Œ]  [ë³€ê²½]              â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## 7. ë³€ê²½ ì´ë ¥ ê´€ë¦¬

### 7.1 UserStatusChangeLog ì—”í‹°í‹°

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                   UserStatusChangeLog                       â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  id                  BIGINT PK AUTO_INCREMENT               â”‚
â”‚  userId              BIGINT NOT NULL                        â”‚
â”‚  fromStatus          VARCHAR(20) NOT NULL                   â”‚
â”‚  toStatus            VARCHAR(20) NOT NULL                   â”‚
â”‚  reason              TEXT                                   â”‚
â”‚  changedBy           BIGINT NOT NULL                        â”‚
â”‚  changedAt           TIMESTAMP NOT NULL                     â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### 7.2 UserRoleChangeLog ì—”í‹°í‹°

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    UserRoleChangeLog                        â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  id                  BIGINT PK AUTO_INCREMENT               â”‚
â”‚  userId              BIGINT NOT NULL                        â”‚
â”‚  fromRole            VARCHAR(20) NOT NULL                   â”‚
â”‚  toRole              VARCHAR(20) NOT NULL                   â”‚
â”‚  reason              TEXT                                   â”‚
â”‚  changedBy           BIGINT NOT NULL                        â”‚
â”‚  changedAt           TIMESTAMP NOT NULL                     â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## 8. ì¸ë±ìŠ¤

```sql
-- íšŒì› ê²€ìƒ‰ìš©
CREATE INDEX idx_users_name ON users(name);
CREATE INDEX idx_users_phone ON users(phone);
CREATE INDEX idx_users_created_at ON users(created_at DESC);

-- ë³€ê²½ ì´ë ¥ ì¡°íšŒìš©
CREATE INDEX idx_status_log_user ON user_status_change_logs(user_id);
CREATE INDEX idx_status_log_changed_at ON user_status_change_logs(changed_at DESC);
CREATE INDEX idx_role_log_user ON user_role_change_logs(user_id);
CREATE INDEX idx_role_log_changed_at ON user_role_change_logs(changed_at DESC);
```

---

## 9. ë³´ì•ˆ ì„¤ì •

### 9.1 Spring Security ì„¤ì •

```java
@Configuration
@EnableMethodSecurity
public class SecurityConfig {

    @Bean
    public SecurityFilterChain filterChain(HttpSecurity http) throws Exception {
        return http
            .authorizeHttpRequests(auth -> auth
                .requestMatchers("/admin/**").hasAnyRole("ADMIN", "SUPER_ADMIN")
                .requestMatchers("/admin/users/*/role").hasRole("SUPER_ADMIN")
                .requestMatchers(HttpMethod.POST, "/admin/users").hasRole("SUPER_ADMIN")
                .anyRequest().authenticated()
            )
            .build();
    }
}
```

### 9.2 ë©”ì†Œë“œ ë³´ì•ˆ

```java
@Service
public class AdminUserService {

    @PreAuthorize("hasAnyRole('ADMIN', 'SUPER_ADMIN')")
    public Page<UserListDto> searchUsers(...) { }

    @PreAuthorize("hasAnyRole('ADMIN', 'SUPER_ADMIN')")
    public UserDetailDto getUserDetail(Long id) { }

    @PreAuthorize("hasRole('SUPER_ADMIN')")
    public void changeRole(Long userId, RoleChangeRequest request) { }

    @PreAuthorize("hasRole('SUPER_ADMIN')")
    public void createAdmin(AdminCreateRequest request) { }
}
```

---

## 10. ê°ì‚¬ ë¡œê·¸

### 10.1 ê´€ë¦¬ì í™œë™ ë¡œê·¸

ëª¨ë“  ê´€ë¦¬ì ì‘ì—…ì€ ê°ì‚¬ ë¡œê·¸ë¡œ ê¸°ë¡ë©ë‹ˆë‹¤.

```java
@Aspect
@Component
public class AdminAuditAspect {

    @AfterReturning("@annotation(AdminAudit)")
    public void logAdminAction(JoinPoint joinPoint) {
        String action = getActionName(joinPoint);
        String targetId = getTargetId(joinPoint);
        Long adminId = SecurityUtils.getCurrentUserId();

        AdminAuditLog log = new AdminAuditLog();
        log.setAdminId(adminId);
        log.setAction(action);
        log.setTargetType("USER");
        log.setTargetId(targetId);
        log.setIpAddress(RequestUtils.getClientIp());
        log.setCreatedAt(LocalDateTime.now());

        auditLogRepository.save(log);
    }
}
```

### 10.2 ê°ì‚¬ ë¡œê·¸ ì¡°íšŒ UI

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  í™œë™ ë¡œê·¸ - í™ê¸¸ë™ (user@example.com)                                   â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  ì¼ì‹œ                â”‚ ì‘ì—…ì     â”‚ ì‘ì—…           â”‚ ìƒì„¸               â”‚
â”‚â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ â”‚
â”‚  2025-01-25 10:30   â”‚ ê¹€ê´€ë¦¬    â”‚ ìƒíƒœ ë³€ê²½      â”‚ í™œì„± â†’ ì •ì§€        â”‚
â”‚  2025-01-24 15:20   â”‚ ë°•ê´€ë¦¬    â”‚ ì •ë³´ ìˆ˜ì •      â”‚ ì „í™”ë²ˆí˜¸ ë³€ê²½      â”‚
â”‚  2025-01-20 14:30   â”‚ ì‹œìŠ¤í…œ    â”‚ ê³„ì • ìƒì„±      â”‚ íšŒì›ê°€ì…           â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

